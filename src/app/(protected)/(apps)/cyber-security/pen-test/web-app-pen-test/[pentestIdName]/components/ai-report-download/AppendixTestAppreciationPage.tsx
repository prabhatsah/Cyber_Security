import React from 'react';
import {
    Text,
    View,
    Image,
    StyleSheet,
} from '@react-pdf/renderer';
import WaterMarkedPage from './WaterMarkedPage';

const appreciationLevelDemoChartUrl = '/IkonApps/assets/images/appendix_test_appreciation_level.png';

const styles = StyleSheet.create({
    pageContent: {
        flexDirection: 'column',
        justifyContent: 'space-between',
        height: '100%',
    },
    heading: {
        fontSize: 30,
        marginBottom: 15,
    },
    activityTitle: {
        fontSize: 14,
        color: '#343335',
        marginBottom: 5,
    },
    paragraph: {
        fontSize: 10,
        color: '#545355',
        marginBottom: 15,
        textAlign: 'justify',
    },
    table: {
        marginBottom: 15,
        borderWidth: 1,
        borderColor: '#d1d5db',
    },
    metaRow: {
        flexDirection: 'row',
        alignItems: 'center',
        backgroundColor: '#cccdc9',
        fontSize: 8.5,
        fontWeight: 'bold',
        color: '#343335',
        textTransform: 'uppercase',
        paddingTop: 8,
        paddingBottom: 1,
        paddingHorizontal: 10,
        opacity: 0.5,
    },
    metaLabel: {
        width: '20%',
        opacity: 1,
    },
    metaValue: {
        width: '80%',
        opacity: 1,
    },
    dataRow: {
        flexDirection: 'row',
        alignItems: 'center',
        fontSize: 10,
        color: '#545355',
        borderTopWidth: 1,
        borderColor: '#d1d5db',
        paddingTop: 8,
        paddingBottom: 1,
        paddingHorizontal: 10,
    },
    dataLabel: {
        width: '20%',
        flexDirection: 'row',
    },
    dataValue: {
        width: '80%',
    },
    legendBox: {
        width: 10,
        height: 10,
        marginRight: 4,
        marginVertical: 0
    },
    image: {
        width: 200,
        marginBottom: 10
    },
    pageNumber: {
        justifySelf: 'flex-end',
        alignSelf: 'flex-end',
        fontSize: 10,
        color: '#aaa',
    },
});

interface AppendixTestAppreciationPageProps {
    companyLogoSrc: string;
    pageNumber: number;
}

const testAppreciationObj = {
    'Effective': {
        color: "#54bb5f",
        description: "The web application demonstrated strong and effective security controls. No vulnerabilities or only negligible issues were identified. Very few, if any, recommendations were issued. The application is considered secure under typical threat conditions."
    },
    'Adequate': {
        color: "#ffd85f",
        description: "The application’s security measures are largely effective but could benefit from improvements. Some vulnerabilities were identified, and corresponding recommendations have been issued to minimize potential impacts. The overall security posture is acceptable with minor adjustments."
    },
    'Partial': {
        color: "#faa439",
        description: "The existing security controls are partially effective. Several weaknesses were observed, and their remediation is necessary to significantly improve the application’s defense capabilities. The suggested recommendations are expected to reduce the organization’s risk exposure meaningfully."
    },
    'Exposed': {
        color: "#e31d1a",
        description: "The assessment revealed multiple ineffective or poorly implemented security controls. Several vulnerabilities were found that could significantly compromise the system if left unaddressed. Immediate action is strongly advised to enhance the organization's overall security posture and reduce risk."
    },
}

const AppendixTestAppreciationPage: React.FC<AppendixTestAppreciationPageProps> = ({ companyLogoSrc, pageNumber }) => (
    <WaterMarkedPage companyLogoSrc={companyLogoSrc} sectionHeader='Report Appendix' backgroundColor='#e3e4df'>
        <View style={styles.pageContent}>
            <View>
                <View style={{ flexDirection: 'row', marginBottom: 15 }}>
                    <Text style={[styles.heading, { fontWeight: 700, marginRight: 4 }]}>Appendix D:</Text>
                    <Text style={styles.heading}>Test Appreciation Levels</Text>
                </View>

                <Text style={styles.paragraph}>
                    The Test Appreciation Level is a qualitative indicator of the overall security posture of the client’s web application, as assessed during the penetration testing engagement. It is determined based on the number and severity of vulnerabilities discovered, the effectiveness of existing security controls, and the effort required to mitigate identified risks.
                </Text>


                <Text style={[styles.paragraph, { marginBottom: 5 }]}>
                    This rating provides stakeholders with a high-level summary of the current state of security and is intended to guide prioritization of remediation efforts. The application is categorized into one of the following four levels:
                </Text>

                <View style={styles.table}>
                    {/* First Row with Gray Background and Smaller Font */}
                    <View style={styles.metaRow}>
                        <Text style={styles.metaLabel}>LEVEL</Text>
                        <Text style={styles.metaValue}>DESCRIPTION</Text>
                    </View>


                    {Object.entries(testAppreciationObj).map(([appreciationLevel, levelObj], index) => {
                        return (
                            <View key={`test-appreciation-level-${index}`} style={styles.dataRow}>
                                <View style={styles.dataLabel}>
                                    <View style={[styles.legendBox, { backgroundColor: levelObj.color }]} />
                                    <Text style={{ fontWeight: 'bold' }}>{appreciationLevel}</Text>
                                </View>
                                <Text style={styles.dataValue}>{levelObj.description}</Text>
                            </View>
                        )
                    })}
                </View>

                <Text style={[styles.paragraph, { marginBottom: 0 }]}>
                    Graphic representation of the overall security posture based on the test appreciation level assigned to the web application.
                </Text>
                <View style={{ flexDirection: 'row', justifyContent: 'center', alignItems: 'center' }}>
                    <Image src={appreciationLevelDemoChartUrl} style={styles.image} />
                </View>
                <Text style={[styles.paragraph, { fontWeight: 700, textAlign: 'center' }]}>Overall Appreciation Level</Text>
            </View>

            <Text style={styles.pageNumber}>{pageNumber}</Text>
        </View>
    </WaterMarkedPage >
);

export default AppendixTestAppreciationPage;
