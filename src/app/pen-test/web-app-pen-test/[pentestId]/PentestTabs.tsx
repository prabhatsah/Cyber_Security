'use client';

import { Badge, Card, Divider, Tab, TabGroup, TabList, TabPanel, TabPanels } from '@tremor/react';
import { RiBuildingFill, RiMapPin2Fill, RiUserFill, RiTimeLine, RiAlarmWarningFill, RiCheckLine } from '@remixicon/react';
import ReconnaissanceConfigFormData from '../../reconnaissance-pen-test/page';
import React, { JSX } from 'react';
import PenTestBasicDetails from './components/PenTestBasicDetails';
import NoSavedPentestTemplate from './components/NoSavedPentestTemplate';
import { BasicDetails, PenTestModified } from '../components/type';

const getPriorityColor = (priority: string) => {
    switch (priority.toLowerCase()) {
        case 'high':
            return 'red';
        case 'medium':
            return 'orange';
        case 'low':
            return 'green';
        default:
            return 'gray';
    }
};

const getSecurityLevelColor = (level: string) => {
    switch (level.toLowerCase()) {
        case 'high':
            return 'green';
        case 'medium':
            return 'yellow';
        case 'low':
            return 'red';
        default:
            return 'gray';
    }
};

export default function PentestTabs({ selectedPentestData }: { selectedPentestData: PenTestModified }) {

    const basicDetailsTab: {
        status: string;
        ComponentName: (props: { componentData: BasicDetails }) => JSX.Element;
        componentData: BasicDetails
    } = {
        status: 'Planning',
        ComponentName: PenTestBasicDetails,
        componentData: selectedPentestData.basicDetails,
    };

    const data = [
        {
            status: 'Reconnaissance',
            ComponentName: ReconnaissanceConfigFormData,
            componentData: selectedPentestData.reconnaissance,
        },
        {
            status: 'Vulnerability Scanning',
            ComponentName: NoSavedPentestTemplate,
            componentData: selectedPentestData.vulnerabilityScanning,
        },
        {
            status: 'Exploitation',
            ComponentName: NoSavedPentestTemplate,
            componentData: selectedPentestData.exploitation,
        },
        {
            status: 'Post Exploitation',
            ComponentName: NoSavedPentestTemplate,
            componentData: selectedPentestData.postExploitation,
        },
        {
            status: 'AI Analysis',
            ComponentName: NoSavedPentestTemplate,
            componentData: selectedPentestData.aiAnalysis,
        },
    ];

    return (
        <>
            <Card className="bg-tremor-background-muted p-0 dark:bg-dark-tremor-background-muted h-full">
                <TabGroup>
                    <TabList className="bg-tremor-background-muted px-6 dark:bg-dark-tremor-background-muted mb-2">
                        <>
                            <Tab
                                key={basicDetailsTab.status}
                                className="pb-2.5 font-medium hover:border-gray-300 flex items-center space-x-2"
                            >
                                <span className="font-medium text-tremor-content-strong dark:text-dark-tremor-content-strong">
                                    <span className="mr-2">1.</span> {/* Serial Number */}
                                    {basicDetailsTab.status}
                                </span>
                                {/* Right Tick Icon for Completed Tabs */}
                                {basicDetailsTab.status === 'Completed' && (
                                    <RiCheckLine className="text-green-500" />
                                )}
                            </Tab>
                            {data.map((category, index) => (
                                <Tab
                                    key={category.status}
                                    className="pb-2.5 font-medium hover:border-gray-300 flex items-center space-x-2"
                                >
                                    <span className="font-medium text-tremor-content-strong dark:text-dark-tremor-content-strong">
                                        <span className="mr-2">{index + 2}.</span> {/* Serial Number */}
                                        {category.status}
                                    </span>
                                    {/* Right Tick Icon for Completed Tabs */}
                                    {category.status === 'Completed' && (
                                        <RiCheckLine className="text-green-500" />
                                    )}
                                </Tab>
                            ))}
                        </>
                    </TabList>

                    <TabPanels>
                        <TabPanel
                            key="Planning"
                            className="p-4"
                        >
                            <basicDetailsTab.ComponentName componentData={basicDetailsTab.componentData} />
                        </TabPanel>
                        {data.map((category) => (
                            <TabPanel
                                key={category.status}
                                className="p-4"
                            >
                                {<category.ComponentName componentData={category.componentData} />}
                                {/* ? (
                                        <category.ReconnaissanceComponentTab />
                                    ) : category.orders.map((order) => (
                                        <Card key={order.penTestName} className="bg-gray-50 p-6 hover:bg-gray-100 transition-colors duration-200 mb-4">
                                            <div className="space-y-6">
                                                <div className="flex justify-between items-start">
                                                    <div>
                                                        <h4 className="text-xl font-semibold text-widget-mainHeader">
                                                            {order.penTestName}
                                                        </h4>
                                                        <p className="text-widget-mainDesc max-w-3xl">
                                                            {order.penTestDescription}
                                                        </p>
                                                    </div>
                                                    <div className="flex space-x-2">
                                                        <Badge color={getPriorityColor(order.priority)} size="lg">
                                                            Priority: {order.priority}
                                                        </Badge>
                                                        <Badge color={getSecurityLevelColor(order.securityLevel)} size="lg">
                                                            Security: {order.securityLevel}
                                                        </Badge>
                                                    </div>
                                                </div>
                                                <Divider />
                                                <div className="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">
                                                    <div className="flex items-center space-x-3">
                                                        <RiBuildingFill
                                                            className="size-5 text-blue-600"
                                                            aria-hidden={true}
                                                        />
                                                        <div>
                                                            <p className="text-sm text-widget-mainHeader">Web App Name</p>
                                                            <p className="text-widget-mainDesc font-medium">{order.webAppName}</p>
                                                        </div>
                                                    </div>
                                                    <div className="flex items-center space-x-3">
                                                        <RiMapPin2Fill
                                                            className="size-5 text-green-600"
                                                            aria-hidden={true}
                                                        />
                                                        <div>
                                                            <p className="text-sm text-widget-mainHeader">Scope</p>
                                                            <p className="text-widget-mainDesc font-medium">{order.scope}</p>
                                                        </div>
                                                    </div>
                                                    <div className="flex items-center space-x-3">
                                                        <RiUserFill
                                                            className="size-5 text-purple-600"
                                                            aria-hidden={true}
                                                        />
                                                        <div>
                                                            <p className="text-sm text-widget-mainHeader">Testing Type</p>
                                                            <p className="text-widget-mainDesc font-medium">{order.typeOfTesting}</p>
                                                        </div>
                                                    </div>
                                                    <div className="flex items-center space-x-3">
                                                        <RiTimeLine
                                                            className="size-5 text-orange-600"
                                                            aria-hidden={true}
                                                        />
                                                        <div>
                                                            <p className="text-sm text-widget-mainHeader">Duration</p>
                                                            <p className="text-widget-mainDesc font-medium">
                                                                {order.startDate} - {order.endDate}
                                                            </p>
                                                        </div>
                                                    </div>
                                                    <div className="flex items-center space-x-3">
                                                        <RiAlarmWarningFill
                                                            className="size-5 text-yellow-600"
                                                            aria-hidden={true}
                                                        />
                                                        <div>
                                                            <p className="text-sm text-widget-mainHeader">Time Zone</p>
                                                            <p className="text-widget-mainDesc font-medium">{order.timeZone}</p>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                        </Card>
                                    )) */}
                            </TabPanel>
                        ))}
                    </TabPanels>
                </TabGroup>
            </Card>
        </>
    );
}
