import { RenderAppBreadcrumb } from "@/components/app-breadcrumb";
import { PentestProvider } from "../components/PentestContext";
import ReconnaissanceTabs from "./components/ReconnaissanceTabs";

export default async function RootLayout({
  children,
  params
}: {
  children: React.ReactNode;
  params: { pentestIdName: string };
}) {
  const pentestIdName = params.pentestIdName;
  const [pentestId, pentestNameInUrl] = pentestIdName.split("_");
  const pentestName = pentestNameInUrl.split('-').map(word => word.charAt(0).toUpperCase() + word.slice(1)).join(' ');

  return (
    <>
      <RenderAppBreadcrumb
        breadcrumb={{
          level: 0,
          title: "Penetration Testing",
          href: "/pen-test",
        }}
      />
      <RenderAppBreadcrumb
        breadcrumb={{
          level: 1,
          title: "Web Application Penetration Testing",
          href: "/pen-test/web-app-pen-test",
        }}
      />
      <RenderAppBreadcrumb
        breadcrumb={{
          level: 2,
          title: pentestName,
          href: `/pen-test/web-app-pen-test/${pentestIdName}`,
        }}
      />
      <RenderAppBreadcrumb
        breadcrumb={{
          level: 3,
          title: "Reconnaissance",
          href: `/pen-test/web-app-pen-test/${pentestIdName}/reconnaissance`,
        }}
      />


      <PentestProvider>
        <div className="flex flex-col overflow-hidden gap-2 h-full w-full">
          <div className="flex flex-col overflow-hidden">
            <ReconnaissanceTabs pentestIdName={pentestIdName} />
          </div>
          <div className="flex-1 overflow-auto">{children}</div>
        </div>
      </PentestProvider>
    </>
  );
}
