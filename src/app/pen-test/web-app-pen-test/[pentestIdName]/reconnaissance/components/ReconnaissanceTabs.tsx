'use client';

import React, { useEffect } from 'react';
import { Card } from '@tremor/react';
import { usePathname, useRouter } from 'next/navigation';
import Link from 'next/link';
import { ScanSearch, TextSearch } from 'lucide-react';

export default function ReconnaissanceTabs({ pentestIdName }: { pentestIdName: string; }) {
    const [pentestId, pentestNameInUrl] = pentestIdName.split("_");
    const pentestName = pentestNameInUrl.split('-').map(word => word.charAt(0).toUpperCase() + word.slice(1)).join(' ');
    const router = useRouter();
    const pathname = usePathname();

    useEffect(() => {
        if (typeof pentestId === 'string') {
            router.push(tabData[0].href);
        }
    }, [pentestId]);

    const tabData = [
        {
            tabName: 'Active Reconnaissance',
            href: `/pen-test/web-app-pen-test/${pentestIdName}/reconnaissance/active-reconnaissance`,
            Icon: ScanSearch,
        },
        {
            tabName: 'Passive Reconnaissance',
            href: `/pen-test/web-app-pen-test/${pentestIdName}/reconnaissance/passive-reconnaissance`,
            Icon: TextSearch,
        },
    ];

    return (
        <>
            <Card className="bg-tremor-background-muted p-0 dark:bg-dark-tremor-background-muted">
                <nav className="flex gap-3">
                    {tabData.map((eachTab) => {
                        const isActive = pathname.includes(eachTab.tabName.toLowerCase().replace(/\s+/g, '-'));
                        return (
                            <Link
                                key={eachTab.tabName}
                                href={eachTab.href}
                                className={`p-2.5 font-medium flex gap-1.5 items-center ${isActive
                                    ? 'border-b-2 border-blue-500 text-blue-600'
                                    : 'hover:border-gray-300'
                                    }`}
                            >
                                <eachTab.Icon className="-ml-1 size-4" aria-hidden="true" />
                                {eachTab.tabName}
                            </Link>
                        )
                    })}
                </nav>
            </Card>
        </>
    );
}
