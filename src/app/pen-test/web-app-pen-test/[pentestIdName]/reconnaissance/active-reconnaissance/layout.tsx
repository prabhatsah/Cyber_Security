import { RenderAppBreadcrumb } from "@/components/app-breadcrumb";
import { PentestProvider } from "../../components/PentestContext";
import ActiveReconnaissanceSidebar from "./components/ActiveReconnaissanceSidebar";

export default async function RootLayout({
  children,
  params
}: {
  children: React.ReactNode;
  params: { pentestIdName: string };
}) {
  const pentestIdName = params.pentestIdName;
  const [pentestId, pentestNameInUrl] = pentestIdName.split("_");
  const pentestName = pentestNameInUrl.split('-').map(word => word.charAt(0).toUpperCase() + word.slice(1)).join(' ');

  return (
    <>
      <RenderAppBreadcrumb
        breadcrumb={{
          level: 0,
          title: "Penetration Testing",
          href: "/pen-test",
        }}
      />
      <RenderAppBreadcrumb
        breadcrumb={{
          level: 1,
          title: "Web Application Penetration Testing",
          href: "/pen-test/web-app-pen-test",
        }}
      />
      <RenderAppBreadcrumb
        breadcrumb={{
          level: 2,
          title: pentestName,
          href: `/pen-test/web-app-pen-test/${pentestIdName}`,
        }}
      />
      <RenderAppBreadcrumb
        breadcrumb={{
          level: 3,
          title: "Reconnaissance",
          href: `/pen-test/web-app-pen-test/${pentestIdName}/reconnaissance`,
        }}
      />
      <RenderAppBreadcrumb
        breadcrumb={{
          level: 4,
          title: "Active Reconnaissance",
          href: `/pen-test/web-app-pen-test/${pentestIdName}/reconnaissance/active-reconnaissance`,
        }}
      />


      <PentestProvider>
        <div className="flex overflow-hidden gap-4 h-full w-full mt-2">
          <div className="w-64 border-r border-gray-200 dark:border-gray-800">
            <ActiveReconnaissanceSidebar pentestIdName={pentestIdName} />
          </div>
          <div className="flex-1">{children}</div>
        </div>
      </PentestProvider>
    </>
  );
}
