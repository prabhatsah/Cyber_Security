import { portsData } from "../components/ReconnaissanceDummyData";
import {
    Accordion,
    AccordionContent,
    AccordionItem,
    AccordionTrigger,
} from "@/components/Accordion";
import { BasicInfoWidget } from "@/components/BasicInfoWidget";
import { EthernetPort } from "lucide-react";

export default function ActiveReconnaissanceOpenPorts() {
    return (
        <>
            <div className="w-full h-full overflow-auto">
                <h2 className="font-semibold text-widgetHeader">
                    Open Ports
                </h2>
                <Accordion type="multiple" className="">
                    {portsData.ports.map((eachPortData, index) => {
                        const stateFormatted = eachPortData.state.charAt(0).toUpperCase() + eachPortData.state.slice(1);

                        const eachPortDataForWidget = [
                            { name: "Protocol", value: eachPortData.protocol.toUpperCase() },
                            { name: "State", value: stateFormatted },
                            { name: "Service", value: eachPortData.service.toUpperCase() },
                            { name: "Product", value: eachPortData.product },
                            { name: "Version", value: eachPortData.version },
                        ];

                        return (
                            <AccordionItem value={`port_${index}`} key={`port_${index}`} >
                                <AccordionTrigger>
                                    <span className="flex items-center gap-2 h-8">
                                        <EthernetPort className="size-4 text-blue-500" />{" "}
                                        Port {eachPortData.port}
                                    </span>
                                </AccordionTrigger>
                                <AccordionContent className="max-h-80 overflow-auto">
                                    <BasicInfoWidget items={eachPortDataForWidget} columns={5} />
                                </AccordionContent>
                            </AccordionItem>
                        )
                    })}
                </Accordion>
            </div>
        </>
    )
}