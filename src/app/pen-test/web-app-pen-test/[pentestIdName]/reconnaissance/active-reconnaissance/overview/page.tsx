import { Cpu, EthernetPort, Network } from "lucide-react";
import { aMassData, portsData, subDomainsData, technologiesData, } from "../components/ReconnaissanceDummyData";
import OverviewTopWidget from "./components/OverviewTopWidget";
import TopFiveCriticalDataWidget from "./components/TopFiveCriticalDataWidget";
import OverviewChartWidget from "./components/OverviewChartWidget";
import { Card, Title } from "@tremor/react";
import { BasicInfoWidget } from "@/components/BasicInfoWidget";
import OverviewMainTemplate from "./OverviewMainTemplate";

export interface BasicInfoWidgetData {
    name: string;
    value: string;
}

export default async function ActiveReconnaissanceOverview({ params }: { params: Promise<{ pentestIdName: string }> }) {
    const pentestIdName = (await params).pentestIdName;

    const whatWebData = technologiesData[technologiesData.length - 1];

    const basicInfoWidgetData: BasicInfoWidgetData[] = [
        {
            name: "URL/Domain",
            value: whatWebData.url,
        },
        {
            name: "Title",
            value: whatWebData.title,
        },
        {
            name: "IP Address",
            value: whatWebData.ip,
        },
        {
            name: "Status",
            value: whatWebData.status,
        },
        {
            name: "Country",
            value: whatWebData.country,
        }
    ];

    const subDomains = aMassData.subdomains
        .filter((item) => item && item.trim() !== "")
        .map((item) => item.split(" --> ")[2].split(" ")[0].trim());

    const overviewTopWidgetData = [
        {
            title: "Sub Domains Discovered",
            value: subDomains.length,
            Icon: Network
        },
        {
            title: "Open Ports Discovered",
            value: portsData.ports.length,
            Icon: EthernetPort
        },
        {
            title: "Technologies Identified",
            value: whatWebData.summary.length,
            Icon: Cpu
        }
    ];

    const ports = portsData.ports.map(eachPorts => eachPorts.port);
    const technologies = whatWebData.summary.split(", ");

    return (
        <>
            {/* <div className="flex flex-col gap-3">
                <OverviewTopWidget overviewTopWidgetData={overviewTopWidgetData} />
                <Card className="flex flex-col gap-3 p-4 rounded-md">
                    <Title className="font-bold text-widget-title text-widgetHeader">Basic Information</Title>
                    <BasicInfoWidget items={basicInfoWidgetData} columns={3} useDefault={false} />
                </Card>
                <TopFiveCriticalDataWidget subDomains={subDomains} ports={ports} technologies={technologies} />
            </div> */}

            <OverviewMainTemplate pentestIdName={pentestIdName} />
        </>
    )
}