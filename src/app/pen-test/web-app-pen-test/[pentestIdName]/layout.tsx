import { RenderAppBreadcrumb } from "@/components/app-breadcrumb";
import { PentestProvider } from "./components/PentestContext";
import PentestTabs from "./components/PentestTabs";
import { Badge } from "@/components/Badge";
import PentestProgressBar from "./components/PentestProgressBar";


export default async function RootLayout({
  children,
  params
}: {
  children: React.ReactNode;
  params: Promise<{ pentestIdName: string }>;
}) {

  const pentestIdName = (await params).pentestIdName;
  const [pentestId, pentestNameInUrl] = pentestIdName.split("_");
  const pentestName = pentestNameInUrl.split('-').map(word => word.charAt(0).toUpperCase() + word.slice(1)).join(' ');

  return (
    <>
      <RenderAppBreadcrumb
        breadcrumb={{
          level: 0,
          title: "Penetration Testing",
          href: "/pen-test",
        }}
      />
      <RenderAppBreadcrumb
        breadcrumb={{
          level: 1,
          title: "Web Application Penetration Testing",
          href: "/pen-test/web-app-pen-test",
        }}
      />
      <RenderAppBreadcrumb
        breadcrumb={{
          level: 2,
          title: pentestName,
          // href: `/pen-test/web-app-pen-test/${pentestIdName}`,
        }}
      />

      <PentestProvider>
        <div className="flex flex-col gap-3 overflow-hidden h-full w-full p-0 ">
          <div className="flex flex-col justify-between gap-3">
            <Badge className="text-widgetHeader p-2 text-xl flex items-center justify-between">
              <span>{pentestName}</span>
              {/* <div className="flex items-center gap-2">
                <div className="w-40 bg-gray-200 rounded-full h-2.5">
                  <div className="bg-blue-600 h-2.5 rounded-full" style={{ width: '0%' }}></div>
                </div>
                <div className="text-xs text-widget-mainDesc mt-1">0%</div>
              </div> */}
              <PentestProgressBar pentestIdName={pentestIdName} />
            </Badge>
            <div className="flex flex-col overflow-hidden">
              <PentestTabs pentestIdName={pentestIdName} />
            </div>
          </div>
          <div className="flex-1 overflow-y-auto" id="all-tabs-content">{children}</div>
        </div>
      </PentestProvider>
    </>
  );
}
