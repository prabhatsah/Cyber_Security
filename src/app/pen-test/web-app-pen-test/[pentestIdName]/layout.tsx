import { RenderAppBreadcrumb } from "@/components/app-breadcrumb";
import { PentestProvider } from "./components/PentestContext";
import PentestTabs from "./components/PentestTabs";


export default async function RootLayout({
  children,
  params
}: {
  children: React.ReactNode;
  params: Promise<{ pentestIdName: string }>;
}) {

  const pentestIdName = (await params).pentestIdName;
  const [pentestId, pentestNameInUrl] = pentestIdName.split("_");
  const pentestName = pentestNameInUrl.split('-').map(word => word.charAt(0).toUpperCase() + word.slice(1)).join(' ');

  return (
    <>
      <RenderAppBreadcrumb
        breadcrumb={{
          level: 0,
          title: "Penetration Testing",
          href: "/pen-test",
        }}
      />
      <RenderAppBreadcrumb
        breadcrumb={{
          level: 1,
          title: "Web Application Penetration Testing",
          href: "/pen-test/web-app-pen-test",
        }}
      />
      <RenderAppBreadcrumb
        breadcrumb={{
          level: 2,
          title: pentestName,
          href: `/pen-test/web-app-pen-test/${pentestIdName}`,
        }}
      />

      <PentestProvider>
        <div className="flex flex-col gap-4 overflow-hidden h-full w-full bg-tremor-background-muted dark:bg-dark-tremor-background-muted">
          <div className="flex flex-col justify-between gap-2 pt-4">
            <h2 className="text-widgetHeader px-6">{pentestName}</h2>
            <div className="flex flex-col overflow-hidden">
              <PentestTabs pentestIdName={pentestIdName} />
            </div>
          </div>
          <div className="flex-1 px-4 overflow-auto">{children}</div>
        </div>
      </PentestProvider>
    </>
  );
}
