import React from "react";

import { RenderAppBreadcrumb } from "@/components/app-breadcrumb";
import PenTestConfigFormData from "./PentestConfigFormData";
import AddPentestBtnWithFormModal from "./AddPentestBtnWithFormModal";
import { fetchData } from "@/utils/api";


export default async function PenTestConfiguration({
    params,
}: {
    params: Promise<{ pentestConfig: string }>;
}) {
    const pentestConfigUrl = (await params).pentestConfig;
    const pentestConfigName = pentestConfigUrl
        .split("-") // Split the string at hyphens
        .map((word) =>
            word === "ibm"
                ? word.toUpperCase()
                : word.charAt(0).toUpperCase() + word.slice(1)
        ) // Capitalize the first letter of each word
        .join(" ");


    let fetchedData = await fetchData("configured_pentest", "id", [
        {
            column: "userid",
            value: "be7a0ece-f3d8-4c5b-84dc-52c32c4adff4"
        }
    ], null);
    fetchedData = fetchedData.data;
    console.log("Fetched data ", fetchedData);

    return (
        <>
            <RenderAppBreadcrumb
                breadcrumb={{
                    level: 0,
                    title: "Penetration Testing",
                    href: "/pen-test",
                }}
            />
            <RenderAppBreadcrumb
                breadcrumb={{
                    level: 1,
                    title: "Web Application Penetration Testing",
                    href: "/pen-test/web-app-pen-test",
                }}
            />
            <RenderAppBreadcrumb
                breadcrumb={{
                    level: 2,
                    title: pentestConfigName,
                    href: `/pen-test/web-app-pen-test/${pentestConfigUrl}`,
                }}
            />

            <div className='flex items-center justify-between mb-4'>
                <h2 className='mb-4 text-widgetHeader'>Configure Pentest</h2>
                <AddPentestBtnWithFormModal pentestConfigUrl={pentestConfigUrl} />
            </div>
            <div className='flex items-center mb-4 flex-col'>
                <PenTestConfigFormData />
            </div>
        </>
    );
}
