import { getLoggedInUserProfile } from "@/ikon/utils/api/loginService";
import * as api from "@/utils/api";

const tableName = "configured_pentest";

export async function addPentestEntry(
  pentestId: string,
  pentestType: string,
  basicDetails: any
) {
  const userId = (await getLoggedInUserProfile()).USER_ID;
  console.log("this is the userId---> " + userId);

  const valuesArr: Record<string, any>[] = [
    { column: "userid", value: [userId] },
    { column: "basic_details", value: [basicDetails] },
    { column: "reconnaissance", value: ["null"] },
    { column: "vulnerability_scanning", value: ["null"] },
    { column: "exploitation", value: ["null"] },
    { column: "post_exploitation", value: ["null"] },
    { column: "ai_analysis", value: ["null"] },
    { column: "pentestid", value: [pentestId] },
    { column: "pentest_type", value: [pentestType] },
  ];

  const result = await api.addColumn(tableName, valuesArr);
  console.log("INSERTION RESULT: ", result);
}

export function addNewConfiguration(newConfigData: any, cloudProvider: string) {
  console.log("New Config Data: ", newConfigData);
  api.updateColumn(
    tableName,
    "data",
    newConfigData,
    newConfigData.configId,
    cloudProvider
  );
}
