import React from "react";

import { RenderAppBreadcrumb } from "@/components/app-breadcrumb";
import { fetchData } from "@/utils/api";
import { redirect } from "next/navigation";

export async function fetchSelectedPentestData(pentestId: string) {
    const fetchedData = await fetchData("pentest_data", "last_scan_on", [{ table: "pentest_data", column: "pentestid", value: pentestId }], null);
    return fetchedData;
}

export default async function NetworkPenTestConfiguration({
    params,
}: {
    params: Promise<{ pentestIdName: string }>;
}) {
    const pentestIdName = (await params).pentestIdName;
    const [pentestId, pentestName] = decodeURIComponent(pentestIdName).split("_");

    console.log("Pen Test URL: ", pentestIdName);

    return (
        <>
            <RenderAppBreadcrumb
                breadcrumb={{
                    level: 0,
                    title: "Penetration Testing",
                    href: "/pen-test",
                }}
            />
            <RenderAppBreadcrumb
                breadcrumb={{
                    level: 1,
                    title: "Network Penetration Testing",
                    href: "/pen-test/network-pen-test",
                }}
            />
            <RenderAppBreadcrumb
                breadcrumb={{
                    level: 2,
                    title: pentestName,
                }}
            />

            {redirect(`/pen-test/network-pen-test/${pentestIdName}/reconnaissance`)}
        </>
    );
}
