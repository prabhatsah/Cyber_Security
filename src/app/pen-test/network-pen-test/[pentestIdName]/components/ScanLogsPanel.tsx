"use client"

import { useEffect, useMemo, useRef, useState } from "react"
import { Card, CardContent, CardHeader, CardTitle } from "@/components/ui/card"
import { Tabs, TabsContent, TabsList, TabsTrigger } from "@/components/ui/tabs"
import { Badge } from "@/components/ui/badge"
import { ScrollArea } from "@/components/ui/scroll-area"
import { Button } from "@/components/ui/button"
import { Terminal, Clock, AlertCircle, CheckCircle, X } from "lucide-react"

interface LogEntry {
    timestamp: string
    level: "info" | "warning" | "error" | "success"
    tool: string
    message: string
    defaultHeight?: number;
}

interface ScanLogsPanelProps {
    resizablePanelHeight: number
    lineIntervalMs?: number
    loop?: boolean
}

export default function ScanLogsPanel({ resizablePanelHeight, lineIntervalMs = 250, loop = false }: ScanLogsPanelProps) {
    const eachTabHeight = `h-${resizablePanelHeight / 10}`;
    const logs: LogEntry[] = useMemo(
        () => [
            { timestamp: "2024-01-15 10:30:00", level: "info", tool: "System", message: "Starting scanning process..." },
            { timestamp: "2024-01-15 10:30:05", level: "info", tool: "Nmap", message: "Nmap scan started on 192.168.1.0/24 (TCP SYN scan)" },
            { timestamp: "2024-01-15 10:30:06", level: "success", tool: "Nmap", message: "Discovered host: 192.168.1.1 (Gateway)" },
            { timestamp: "2024-01-15 10:30:07", level: "success", tool: "Nmap", message: "Discovered host: 192.168.1.10 (Windows Server)" },
            { timestamp: "2024-01-15 10:30:08", level: "info", tool: "Nmap", message: "Port scan: 22/tcp open ssh" },
            { timestamp: "2024-01-15 10:30:09", level: "info", tool: "Nmap", message: "Port scan: 80/tcp open http" },
            { timestamp: "2024-01-15 10:30:10", level: "info", tool: "Nmap", message: "Port scan: 443/tcp open https" },
            { timestamp: "2024-01-15 10:30:11", level: "success", tool: "Nmap", message: "Nmap scan completed successfully" },
            { timestamp: "2024-01-15 10:31:00", level: "info", tool: "ARP-Scan", message: "ARP scan initiated for local network" },
            { timestamp: "2024-01-15 10:31:01", level: "success", tool: "ARP-Scan", message: "Discovered host: 192.168.1.20 (Linux Workstation)" },
            { timestamp: "2024-01-15 10:31:02", level: "success", tool: "ARP-Scan", message: "Discovered host: 192.168.1.30 (Printer)" },
            { timestamp: "2024-01-15 10:31:03", level: "success", tool: "ARP-Scan", message: "ARP scan completed successfully" },
            { timestamp: "2024-01-15 10:32:00", level: "info", tool: "Masscan", message: "Masscan initiated on 192.168.1.0/24 (high-speed scan)" },
            { timestamp: "2024-01-15 10:32:01", level: "info", tool: "Masscan", message: "Open port detected: 445/tcp (SMB) on 192.168.1.10" },
            { timestamp: "2024-01-15 10:32:02", level: "info", tool: "Masscan", message: "Open port detected: 3389/tcp (RDP) on 192.168.1.10" },
            { timestamp: "2024-01-15 10:32:03", level: "success", tool: "Masscan", message: "Masscan completed successfully" },
            { timestamp: "2024-01-15 10:35:01", level: "info", tool: "Nessus", message: "Initializing vulnerability scanner" },
            { timestamp: "2024-01-15 10:35:02", level: "info", tool: "Nessus", message: "Loading vulnerability database..." },
            { timestamp: "2024-01-15 10:35:03", level: "warning", tool: "Nessus", message: "CVE-2021-44228 (Log4Shell) detected on 192.168.1.10:8080" },
            { timestamp: "2024-01-15 10:35:04", level: "error", tool: "Nessus", message: "Critical vulnerability CVE-2020-1472 (Zerologon) found" },
            { timestamp: "2024-01-15 10:35:05", level: "warning", tool: "Nessus", message: "SMB vulnerabilities detected on multiple hosts" },
            { timestamp: "2024-01-15 10:35:06", level: "success", tool: "Nessus", message: "Vulnerability scan completed" },
            { timestamp: "2024-01-15 10:30:00", level: "info", tool: "System", message: "Starting scanning process..." },
            { timestamp: "2024-01-15 10:30:05", level: "info", tool: "Nmap", message: "Nmap scan started on 192.168.1.0/24 (TCP SYN scan)" },
            { timestamp: "2024-01-15 10:30:06", level: "success", tool: "Nmap", message: "Discovered host: 192.168.1.1 (Gateway)" },
            { timestamp: "2024-01-15 10:30:07", level: "success", tool: "Nmap", message: "Discovered host: 192.168.1.10 (Windows Server)" },
            { timestamp: "2024-01-15 10:30:08", level: "info", tool: "Nmap", message: "Port scan: 22/tcp open ssh" },
            { timestamp: "2024-01-15 10:30:09", level: "info", tool: "Nmap", message: "Port scan: 80/tcp open http" },
            { timestamp: "2024-01-15 10:30:10", level: "info", tool: "Nmap", message: "Port scan: 443/tcp open https" },
            { timestamp: "2024-01-15 10:30:11", level: "success", tool: "Nmap", message: "Nmap scan completed successfully" },
            { timestamp: "2024-01-15 10:31:00", level: "info", tool: "ARP-Scan", message: "ARP scan initiated for local network" },
            { timestamp: "2024-01-15 10:31:01", level: "success", tool: "ARP-Scan", message: "Discovered host: 192.168.1.20 (Linux Workstation)" },
            { timestamp: "2024-01-15 10:31:02", level: "success", tool: "ARP-Scan", message: "Discovered host: 192.168.1.30 (Printer)" },
            { timestamp: "2024-01-15 10:31:03", level: "success", tool: "ARP-Scan", message: "ARP scan completed successfully" },
            { timestamp: "2024-01-15 10:32:00", level: "info", tool: "Masscan", message: "Masscan initiated on 192.168.1.0/24 (high-speed scan)" },
            { timestamp: "2024-01-15 10:32:01", level: "info", tool: "Masscan", message: "Open port detected: 445/tcp (SMB) on 192.168.1.10" },
            { timestamp: "2024-01-15 10:32:02", level: "info", tool: "Masscan", message: "Open port detected: 3389/tcp (RDP) on 192.168.1.10" },
            { timestamp: "2024-01-15 10:32:03", level: "success", tool: "Masscan", message: "Masscan completed successfully" },
            { timestamp: "2024-01-15 10:35:01", level: "info", tool: "Nessus", message: "Initializing vulnerability scanner" },
            { timestamp: "2024-01-15 10:35:02", level: "info", tool: "Nessus", message: "Loading vulnerability database..." },
            { timestamp: "2024-01-15 10:35:03", level: "warning", tool: "Nessus", message: "CVE-2021-44228 (Log4Shell) detected on 192.168.1.10:8080" },
            { timestamp: "2024-01-15 10:35:04", level: "error", tool: "Nessus", message: "Critical vulnerability CVE-2020-1472 (Zerologon) found" },
            { timestamp: "2024-01-15 10:35:05", level: "warning", tool: "Nessus", message: "SMB vulnerabilities detected on multiple hosts" },
            { timestamp: "2024-01-15 10:35:06", level: "success", tool: "Nessus", message: "Vulnerability scan completed" },
            { timestamp: "2024-01-15 10:30:00", level: "info", tool: "System", message: "Starting scanning process..." },
            { timestamp: "2024-01-15 10:30:05", level: "info", tool: "Nmap", message: "Nmap scan started on 192.168.1.0/24 (TCP SYN scan)" },
            { timestamp: "2024-01-15 10:30:06", level: "success", tool: "Nmap", message: "Discovered host: 192.168.1.1 (Gateway)" },
            { timestamp: "2024-01-15 10:30:07", level: "success", tool: "Nmap", message: "Discovered host: 192.168.1.10 (Windows Server)" },
            { timestamp: "2024-01-15 10:30:08", level: "info", tool: "Nmap", message: "Port scan: 22/tcp open ssh" },
            { timestamp: "2024-01-15 10:30:09", level: "info", tool: "Nmap", message: "Port scan: 80/tcp open http" },
            { timestamp: "2024-01-15 10:30:10", level: "info", tool: "Nmap", message: "Port scan: 443/tcp open https" },
            { timestamp: "2024-01-15 10:30:11", level: "success", tool: "Nmap", message: "Nmap scan completed successfully" },
            { timestamp: "2024-01-15 10:31:00", level: "info", tool: "ARP-Scan", message: "ARP scan initiated for local network" },
            { timestamp: "2024-01-15 10:31:01", level: "success", tool: "ARP-Scan", message: "Discovered host: 192.168.1.20 (Linux Workstation)" },
            { timestamp: "2024-01-15 10:31:02", level: "success", tool: "ARP-Scan", message: "Discovered host: 192.168.1.30 (Printer)" },
            { timestamp: "2024-01-15 10:31:03", level: "success", tool: "ARP-Scan", message: "ARP scan completed successfully" },
            { timestamp: "2024-01-15 10:32:00", level: "info", tool: "Masscan", message: "Masscan initiated on 192.168.1.0/24 (high-speed scan)" },
            { timestamp: "2024-01-15 10:32:01", level: "info", tool: "Masscan", message: "Open port detected: 445/tcp (SMB) on 192.168.1.10" },
            { timestamp: "2024-01-15 10:32:02", level: "info", tool: "Masscan", message: "Open port detected: 3389/tcp (RDP) on 192.168.1.10" },
            { timestamp: "2024-01-15 10:32:03", level: "success", tool: "Masscan", message: "Masscan completed successfully" },
            { timestamp: "2024-01-15 10:35:01", level: "info", tool: "Nessus", message: "Initializing vulnerability scanner" },
            { timestamp: "2024-01-15 10:35:02", level: "info", tool: "Nessus", message: "Loading vulnerability database..." },
            { timestamp: "2024-01-15 10:35:03", level: "warning", tool: "Nessus", message: "CVE-2021-44228 (Log4Shell) detected on 192.168.1.10:8080" },
            { timestamp: "2024-01-15 10:35:04", level: "error", tool: "Nessus", message: "Critical vulnerability CVE-2020-1472 (Zerologon) found" },
            { timestamp: "2024-01-15 10:35:05", level: "warning", tool: "Nessus", message: "SMB vulnerabilities detected on multiple hosts" },
            { timestamp: "2024-01-15 10:35:06", level: "success", tool: "Nessus", message: "Vulnerability scan completed" },
            { timestamp: "2024-01-15 10:30:00", level: "info", tool: "System", message: "Starting scanning process..." },
            { timestamp: "2024-01-15 10:30:05", level: "info", tool: "Nmap", message: "Nmap scan started on 192.168.1.0/24 (TCP SYN scan)" },
            { timestamp: "2024-01-15 10:30:06", level: "success", tool: "Nmap", message: "Discovered host: 192.168.1.1 (Gateway)" },
            { timestamp: "2024-01-15 10:30:07", level: "success", tool: "Nmap", message: "Discovered host: 192.168.1.10 (Windows Server)" },
            { timestamp: "2024-01-15 10:30:08", level: "info", tool: "Nmap", message: "Port scan: 22/tcp open ssh" },
            { timestamp: "2024-01-15 10:30:09", level: "info", tool: "Nmap", message: "Port scan: 80/tcp open http" },
            { timestamp: "2024-01-15 10:30:10", level: "info", tool: "Nmap", message: "Port scan: 443/tcp open https" },
            { timestamp: "2024-01-15 10:30:11", level: "success", tool: "Nmap", message: "Nmap scan completed successfully" },
            { timestamp: "2024-01-15 10:31:00", level: "info", tool: "ARP-Scan", message: "ARP scan initiated for local network" },
            { timestamp: "2024-01-15 10:31:01", level: "success", tool: "ARP-Scan", message: "Discovered host: 192.168.1.20 (Linux Workstation)" },
            { timestamp: "2024-01-15 10:31:02", level: "success", tool: "ARP-Scan", message: "Discovered host: 192.168.1.30 (Printer)" },
            { timestamp: "2024-01-15 10:31:03", level: "success", tool: "ARP-Scan", message: "ARP scan completed successfully" },
            { timestamp: "2024-01-15 10:32:00", level: "info", tool: "Masscan", message: "Masscan initiated on 192.168.1.0/24 (high-speed scan)" },
            { timestamp: "2024-01-15 10:32:01", level: "info", tool: "Masscan", message: "Open port detected: 445/tcp (SMB) on 192.168.1.10" },
            { timestamp: "2024-01-15 10:32:02", level: "info", tool: "Masscan", message: "Open port detected: 3389/tcp (RDP) on 192.168.1.10" },
            { timestamp: "2024-01-15 10:32:03", level: "success", tool: "Masscan", message: "Masscan completed successfully" },
            { timestamp: "2024-01-15 10:35:01", level: "info", tool: "Nessus", message: "Initializing vulnerability scanner" },
            { timestamp: "2024-01-15 10:35:02", level: "info", tool: "Nessus", message: "Loading vulnerability database..." },
            { timestamp: "2024-01-15 10:35:03", level: "warning", tool: "Nessus", message: "CVE-2021-44228 (Log4Shell) detected on 192.168.1.10:8080" },
            { timestamp: "2024-01-15 10:35:04", level: "error", tool: "Nessus", message: "Critical vulnerability CVE-2020-1472 (Zerologon) found" },
            { timestamp: "2024-01-15 10:35:05", level: "warning", tool: "Nessus", message: "SMB vulnerabilities detected on multiple hosts" },
            { timestamp: "2024-01-15 10:35:06", level: "success", tool: "Nessus", message: "Vulnerability scan completed" },
            { timestamp: "2024-01-15 10:30:00", level: "info", tool: "System", message: "Starting scanning process..." },
            { timestamp: "2024-01-15 10:30:05", level: "info", tool: "Nmap", message: "Nmap scan started on 192.168.1.0/24 (TCP SYN scan)" },
            { timestamp: "2024-01-15 10:30:06", level: "success", tool: "Nmap", message: "Discovered host: 192.168.1.1 (Gateway)" },
            { timestamp: "2024-01-15 10:30:07", level: "success", tool: "Nmap", message: "Discovered host: 192.168.1.10 (Windows Server)" },
            { timestamp: "2024-01-15 10:30:08", level: "info", tool: "Nmap", message: "Port scan: 22/tcp open ssh" },
            { timestamp: "2024-01-15 10:30:09", level: "info", tool: "Nmap", message: "Port scan: 80/tcp open http" },
            { timestamp: "2024-01-15 10:30:10", level: "info", tool: "Nmap", message: "Port scan: 443/tcp open https" },
            { timestamp: "2024-01-15 10:30:11", level: "success", tool: "Nmap", message: "Nmap scan completed successfully" },
            { timestamp: "2024-01-15 10:31:00", level: "info", tool: "ARP-Scan", message: "ARP scan initiated for local network" },
            { timestamp: "2024-01-15 10:31:01", level: "success", tool: "ARP-Scan", message: "Discovered host: 192.168.1.20 (Linux Workstation)" },
            { timestamp: "2024-01-15 10:31:02", level: "success", tool: "ARP-Scan", message: "Discovered host: 192.168.1.30 (Printer)" },
            { timestamp: "2024-01-15 10:31:03", level: "success", tool: "ARP-Scan", message: "ARP scan completed successfully" },
            { timestamp: "2024-01-15 10:32:00", level: "info", tool: "Masscan", message: "Masscan initiated on 192.168.1.0/24 (high-speed scan)" },
            { timestamp: "2024-01-15 10:32:01", level: "info", tool: "Masscan", message: "Open port detected: 445/tcp (SMB) on 192.168.1.10" },
            { timestamp: "2024-01-15 10:32:02", level: "info", tool: "Masscan", message: "Open port detected: 3389/tcp (RDP) on 192.168.1.10" },
            { timestamp: "2024-01-15 10:32:03", level: "success", tool: "Masscan", message: "Masscan completed successfully" },
            { timestamp: "2024-01-15 10:35:01", level: "info", tool: "Nessus", message: "Initializing vulnerability scanner" },
            { timestamp: "2024-01-15 10:35:02", level: "info", tool: "Nessus", message: "Loading vulnerability database..." },
            { timestamp: "2024-01-15 10:35:03", level: "warning", tool: "Nessus", message: "CVE-2021-44228 (Log4Shell) detected on 192.168.1.10:8080" },
            { timestamp: "2024-01-15 10:35:04", level: "error", tool: "Nessus", message: "Critical vulnerability CVE-2020-1472 (Zerologon) found" },
            { timestamp: "2024-01-15 10:35:05", level: "warning", tool: "Nessus", message: "SMB vulnerabilities detected on multiple hosts" },
            { timestamp: "2024-01-15 10:35:06", level: "success", tool: "Nessus", message: "Vulnerability scan completed" },
            { timestamp: "2024-01-15 10:30:00", level: "info", tool: "System", message: "Starting scanning process..." },
            { timestamp: "2024-01-15 10:30:05", level: "info", tool: "Nmap", message: "Nmap scan started on 192.168.1.0/24 (TCP SYN scan)" },
            { timestamp: "2024-01-15 10:30:06", level: "success", tool: "Nmap", message: "Discovered host: 192.168.1.1 (Gateway)" },
            { timestamp: "2024-01-15 10:30:07", level: "success", tool: "Nmap", message: "Discovered host: 192.168.1.10 (Windows Server)" },
            { timestamp: "2024-01-15 10:30:08", level: "info", tool: "Nmap", message: "Port scan: 22/tcp open ssh" },
            { timestamp: "2024-01-15 10:30:09", level: "info", tool: "Nmap", message: "Port scan: 80/tcp open http" },
            { timestamp: "2024-01-15 10:30:10", level: "info", tool: "Nmap", message: "Port scan: 443/tcp open https" },
            { timestamp: "2024-01-15 10:30:11", level: "success", tool: "Nmap", message: "Nmap scan completed successfully" },
            { timestamp: "2024-01-15 10:31:00", level: "info", tool: "ARP-Scan", message: "ARP scan initiated for local network" },
            { timestamp: "2024-01-15 10:31:01", level: "success", tool: "ARP-Scan", message: "Discovered host: 192.168.1.20 (Linux Workstation)" },
            { timestamp: "2024-01-15 10:31:02", level: "success", tool: "ARP-Scan", message: "Discovered host: 192.168.1.30 (Printer)" },
            { timestamp: "2024-01-15 10:31:03", level: "success", tool: "ARP-Scan", message: "ARP scan completed successfully" },
            { timestamp: "2024-01-15 10:32:00", level: "info", tool: "Masscan", message: "Masscan initiated on 192.168.1.0/24 (high-speed scan)" },
            { timestamp: "2024-01-15 10:32:01", level: "info", tool: "Masscan", message: "Open port detected: 445/tcp (SMB) on 192.168.1.10" },
            { timestamp: "2024-01-15 10:32:02", level: "info", tool: "Masscan", message: "Open port detected: 3389/tcp (RDP) on 192.168.1.10" },
            { timestamp: "2024-01-15 10:32:03", level: "success", tool: "Masscan", message: "Masscan completed successfully" },
            { timestamp: "2024-01-15 10:35:01", level: "info", tool: "Nessus", message: "Initializing vulnerability scanner" },
            { timestamp: "2024-01-15 10:35:02", level: "info", tool: "Nessus", message: "Loading vulnerability database..." },
            { timestamp: "2024-01-15 10:35:03", level: "warning", tool: "Nessus", message: "CVE-2021-44228 (Log4Shell) detected on 192.168.1.10:8080" },
            { timestamp: "2024-01-15 10:35:04", level: "error", tool: "Nessus", message: "Critical vulnerability CVE-2020-1472 (Zerologon) found" },
            { timestamp: "2024-01-15 10:35:05", level: "warning", tool: "Nessus", message: "SMB vulnerabilities detected on multiple hosts" },
            { timestamp: "2024-01-15 10:35:06", level: "success", tool: "Nessus", message: "Vulnerability scan completed" },
            { timestamp: "2024-01-15 10:30:00", level: "info", tool: "System", message: "Starting scanning process..." },
            { timestamp: "2024-01-15 10:30:05", level: "info", tool: "Nmap", message: "Nmap scan started on 192.168.1.0/24 (TCP SYN scan)" },
            { timestamp: "2024-01-15 10:30:06", level: "success", tool: "Nmap", message: "Discovered host: 192.168.1.1 (Gateway)" },
            { timestamp: "2024-01-15 10:30:07", level: "success", tool: "Nmap", message: "Discovered host: 192.168.1.10 (Windows Server)" },
            { timestamp: "2024-01-15 10:30:08", level: "info", tool: "Nmap", message: "Port scan: 22/tcp open ssh" },
            { timestamp: "2024-01-15 10:30:09", level: "info", tool: "Nmap", message: "Port scan: 80/tcp open http" },
            { timestamp: "2024-01-15 10:30:10", level: "info", tool: "Nmap", message: "Port scan: 443/tcp open https" },
            { timestamp: "2024-01-15 10:30:11", level: "success", tool: "Nmap", message: "Nmap scan completed successfully" },
            { timestamp: "2024-01-15 10:31:00", level: "info", tool: "ARP-Scan", message: "ARP scan initiated for local network" },
            { timestamp: "2024-01-15 10:31:01", level: "success", tool: "ARP-Scan", message: "Discovered host: 192.168.1.20 (Linux Workstation)" },
            { timestamp: "2024-01-15 10:31:02", level: "success", tool: "ARP-Scan", message: "Discovered host: 192.168.1.30 (Printer)" },
            { timestamp: "2024-01-15 10:31:03", level: "success", tool: "ARP-Scan", message: "ARP scan completed successfully" },
            { timestamp: "2024-01-15 10:32:00", level: "info", tool: "Masscan", message: "Masscan initiated on 192.168.1.0/24 (high-speed scan)" },
            { timestamp: "2024-01-15 10:32:01", level: "info", tool: "Masscan", message: "Open port detected: 445/tcp (SMB) on 192.168.1.10" },
            { timestamp: "2024-01-15 10:32:02", level: "info", tool: "Masscan", message: "Open port detected: 3389/tcp (RDP) on 192.168.1.10" },
            { timestamp: "2024-01-15 10:32:03", level: "success", tool: "Masscan", message: "Masscan completed successfully" },
            { timestamp: "2024-01-15 10:35:01", level: "info", tool: "Nessus", message: "Initializing vulnerability scanner" },
            { timestamp: "2024-01-15 10:35:02", level: "info", tool: "Nessus", message: "Loading vulnerability database..." },
            { timestamp: "2024-01-15 10:35:03", level: "warning", tool: "Nessus", message: "CVE-2021-44228 (Log4Shell) detected on 192.168.1.10:8080" },
            { timestamp: "2024-01-15 10:35:04", level: "error", tool: "Nessus", message: "Critical vulnerability CVE-2020-1472 (Zerologon) found" },
            { timestamp: "2024-01-15 10:35:05", level: "warning", tool: "Nessus", message: "SMB vulnerabilities detected on multiple hosts" },
            { timestamp: "2024-01-15 10:35:06", level: "success", tool: "Nessus", message: "Vulnerability scan completed" },
            { timestamp: "2024-01-15 10:30:00", level: "info", tool: "System", message: "Starting scanning process..." },
            { timestamp: "2024-01-15 10:30:05", level: "info", tool: "Nmap", message: "Nmap scan started on 192.168.1.0/24 (TCP SYN scan)" },
            { timestamp: "2024-01-15 10:30:06", level: "success", tool: "Nmap", message: "Discovered host: 192.168.1.1 (Gateway)" },
            { timestamp: "2024-01-15 10:30:07", level: "success", tool: "Nmap", message: "Discovered host: 192.168.1.10 (Windows Server)" },
            { timestamp: "2024-01-15 10:30:08", level: "info", tool: "Nmap", message: "Port scan: 22/tcp open ssh" },
            { timestamp: "2024-01-15 10:30:09", level: "info", tool: "Nmap", message: "Port scan: 80/tcp open http" },
            { timestamp: "2024-01-15 10:30:10", level: "info", tool: "Nmap", message: "Port scan: 443/tcp open https" },
            { timestamp: "2024-01-15 10:30:11", level: "success", tool: "Nmap", message: "Nmap scan completed successfully" },
            { timestamp: "2024-01-15 10:31:00", level: "info", tool: "ARP-Scan", message: "ARP scan initiated for local network" },
            { timestamp: "2024-01-15 10:31:01", level: "success", tool: "ARP-Scan", message: "Discovered host: 192.168.1.20 (Linux Workstation)" },
            { timestamp: "2024-01-15 10:31:02", level: "success", tool: "ARP-Scan", message: "Discovered host: 192.168.1.30 (Printer)" },
            { timestamp: "2024-01-15 10:31:03", level: "success", tool: "ARP-Scan", message: "ARP scan completed successfully" },
            { timestamp: "2024-01-15 10:32:00", level: "info", tool: "Masscan", message: "Masscan initiated on 192.168.1.0/24 (high-speed scan)" },
            { timestamp: "2024-01-15 10:32:01", level: "info", tool: "Masscan", message: "Open port detected: 445/tcp (SMB) on 192.168.1.10" },
            { timestamp: "2024-01-15 10:32:02", level: "info", tool: "Masscan", message: "Open port detected: 3389/tcp (RDP) on 192.168.1.10" },
            { timestamp: "2024-01-15 10:32:03", level: "success", tool: "Masscan", message: "Masscan completed successfully" },
            { timestamp: "2024-01-15 10:35:01", level: "info", tool: "Nessus", message: "Initializing vulnerability scanner" },
            { timestamp: "2024-01-15 10:35:02", level: "info", tool: "Nessus", message: "Loading vulnerability database..." },
            { timestamp: "2024-01-15 10:35:03", level: "warning", tool: "Nessus", message: "CVE-2021-44228 (Log4Shell) detected on 192.168.1.10:8080" },
            { timestamp: "2024-01-15 10:35:04", level: "error", tool: "Nessus", message: "Critical vulnerability CVE-2020-1472 (Zerologon) found" },
            { timestamp: "2024-01-15 10:35:05", level: "warning", tool: "Nessus", message: "SMB vulnerabilities detected on multiple hosts" },
            { timestamp: "2024-01-15 10:35:06", level: "success", tool: "Nessus", message: "Vulnerability scan completed" },
            { timestamp: "2024-01-15 10:30:00", level: "info", tool: "System", message: "Starting scanning process..." },
            { timestamp: "2024-01-15 10:30:05", level: "info", tool: "Nmap", message: "Nmap scan started on 192.168.1.0/24 (TCP SYN scan)" },
            { timestamp: "2024-01-15 10:30:06", level: "success", tool: "Nmap", message: "Discovered host: 192.168.1.1 (Gateway)" },
            { timestamp: "2024-01-15 10:30:07", level: "success", tool: "Nmap", message: "Discovered host: 192.168.1.10 (Windows Server)" },
            { timestamp: "2024-01-15 10:30:08", level: "info", tool: "Nmap", message: "Port scan: 22/tcp open ssh" },
            { timestamp: "2024-01-15 10:30:09", level: "info", tool: "Nmap", message: "Port scan: 80/tcp open http" },
            { timestamp: "2024-01-15 10:30:10", level: "info", tool: "Nmap", message: "Port scan: 443/tcp open https" },
            { timestamp: "2024-01-15 10:30:11", level: "success", tool: "Nmap", message: "Nmap scan completed successfully" },
            { timestamp: "2024-01-15 10:31:00", level: "info", tool: "ARP-Scan", message: "ARP scan initiated for local network" },
            { timestamp: "2024-01-15 10:31:01", level: "success", tool: "ARP-Scan", message: "Discovered host: 192.168.1.20 (Linux Workstation)" },
            { timestamp: "2024-01-15 10:31:02", level: "success", tool: "ARP-Scan", message: "Discovered host: 192.168.1.30 (Printer)" },
            { timestamp: "2024-01-15 10:31:03", level: "success", tool: "ARP-Scan", message: "ARP scan completed successfully" },
            { timestamp: "2024-01-15 10:32:00", level: "info", tool: "Masscan", message: "Masscan initiated on 192.168.1.0/24 (high-speed scan)" },
            { timestamp: "2024-01-15 10:32:01", level: "info", tool: "Masscan", message: "Open port detected: 445/tcp (SMB) on 192.168.1.10" },
            { timestamp: "2024-01-15 10:32:02", level: "info", tool: "Masscan", message: "Open port detected: 3389/tcp (RDP) on 192.168.1.10" },
            { timestamp: "2024-01-15 10:32:03", level: "success", tool: "Masscan", message: "Masscan completed successfully" },
            { timestamp: "2024-01-15 10:35:01", level: "info", tool: "Nessus", message: "Initializing vulnerability scanner" },
            { timestamp: "2024-01-15 10:35:02", level: "info", tool: "Nessus", message: "Loading vulnerability database..." },
            { timestamp: "2024-01-15 10:35:03", level: "warning", tool: "Nessus", message: "CVE-2021-44228 (Log4Shell) detected on 192.168.1.10:8080" },
            { timestamp: "2024-01-15 10:35:04", level: "error", tool: "Nessus", message: "Critical vulnerability CVE-2020-1472 (Zerologon) found" },
            { timestamp: "2024-01-15 10:35:05", level: "warning", tool: "Nessus", message: "SMB vulnerabilities detected on multiple hosts" },
            { timestamp: "2024-01-15 10:35:06", level: "success", tool: "Nessus", message: "Vulnerability scan completed" },
            { timestamp: "2024-01-15 10:30:00", level: "info", tool: "System", message: "Starting scanning process..." },
            { timestamp: "2024-01-15 10:30:05", level: "info", tool: "Nmap", message: "Nmap scan started on 192.168.1.0/24 (TCP SYN scan)" },
            { timestamp: "2024-01-15 10:30:06", level: "success", tool: "Nmap", message: "Discovered host: 192.168.1.1 (Gateway)" },
            { timestamp: "2024-01-15 10:30:07", level: "success", tool: "Nmap", message: "Discovered host: 192.168.1.10 (Windows Server)" },
            { timestamp: "2024-01-15 10:30:08", level: "info", tool: "Nmap", message: "Port scan: 22/tcp open ssh" },
            { timestamp: "2024-01-15 10:30:09", level: "info", tool: "Nmap", message: "Port scan: 80/tcp open http" },
            { timestamp: "2024-01-15 10:30:10", level: "info", tool: "Nmap", message: "Port scan: 443/tcp open https" },
            { timestamp: "2024-01-15 10:30:11", level: "success", tool: "Nmap", message: "Nmap scan completed successfully" },
            { timestamp: "2024-01-15 10:31:00", level: "info", tool: "ARP-Scan", message: "ARP scan initiated for local network" },
            { timestamp: "2024-01-15 10:31:01", level: "success", tool: "ARP-Scan", message: "Discovered host: 192.168.1.20 (Linux Workstation)" },
            { timestamp: "2024-01-15 10:31:02", level: "success", tool: "ARP-Scan", message: "Discovered host: 192.168.1.30 (Printer)" },
            { timestamp: "2024-01-15 10:31:03", level: "success", tool: "ARP-Scan", message: "ARP scan completed successfully" },
            { timestamp: "2024-01-15 10:32:00", level: "info", tool: "Masscan", message: "Masscan initiated on 192.168.1.0/24 (high-speed scan)" },
            { timestamp: "2024-01-15 10:32:01", level: "info", tool: "Masscan", message: "Open port detected: 445/tcp (SMB) on 192.168.1.10" },
            { timestamp: "2024-01-15 10:32:02", level: "info", tool: "Masscan", message: "Open port detected: 3389/tcp (RDP) on 192.168.1.10" },
            { timestamp: "2024-01-15 10:32:03", level: "success", tool: "Masscan", message: "Masscan completed successfully" },
            { timestamp: "2024-01-15 10:35:01", level: "info", tool: "Nessus", message: "Initializing vulnerability scanner" },
            { timestamp: "2024-01-15 10:35:02", level: "info", tool: "Nessus", message: "Loading vulnerability database..." },
            { timestamp: "2024-01-15 10:35:03", level: "warning", tool: "Nessus", message: "CVE-2021-44228 (Log4Shell) detected on 192.168.1.10:8080" },
            { timestamp: "2024-01-15 10:35:04", level: "error", tool: "Nessus", message: "Critical vulnerability CVE-2020-1472 (Zerologon) found" },
            { timestamp: "2024-01-15 10:35:05", level: "warning", tool: "Nessus", message: "SMB vulnerabilities detected on multiple hosts" },
            { timestamp: "2024-01-15 10:35:06", level: "success", tool: "Nessus", message: "Vulnerability scan completed" },
            { timestamp: "2024-01-15 10:30:00", level: "info", tool: "System", message: "Starting scanning process..." },
            { timestamp: "2024-01-15 10:30:05", level: "info", tool: "Nmap", message: "Nmap scan started on 192.168.1.0/24 (TCP SYN scan)" },
            { timestamp: "2024-01-15 10:30:06", level: "success", tool: "Nmap", message: "Discovered host: 192.168.1.1 (Gateway)" },
            { timestamp: "2024-01-15 10:30:07", level: "success", tool: "Nmap", message: "Discovered host: 192.168.1.10 (Windows Server)" },
            { timestamp: "2024-01-15 10:30:08", level: "info", tool: "Nmap", message: "Port scan: 22/tcp open ssh" },
            { timestamp: "2024-01-15 10:30:09", level: "info", tool: "Nmap", message: "Port scan: 80/tcp open http" },
            { timestamp: "2024-01-15 10:30:10", level: "info", tool: "Nmap", message: "Port scan: 443/tcp open https" },
            { timestamp: "2024-01-15 10:30:11", level: "success", tool: "Nmap", message: "Nmap scan completed successfully" },
            { timestamp: "2024-01-15 10:31:00", level: "info", tool: "ARP-Scan", message: "ARP scan initiated for local network" },
            { timestamp: "2024-01-15 10:31:01", level: "success", tool: "ARP-Scan", message: "Discovered host: 192.168.1.20 (Linux Workstation)" },
            { timestamp: "2024-01-15 10:31:02", level: "success", tool: "ARP-Scan", message: "Discovered host: 192.168.1.30 (Printer)" },
            { timestamp: "2024-01-15 10:31:03", level: "success", tool: "ARP-Scan", message: "ARP scan completed successfully" },
            { timestamp: "2024-01-15 10:32:00", level: "info", tool: "Masscan", message: "Masscan initiated on 192.168.1.0/24 (high-speed scan)" },
            { timestamp: "2024-01-15 10:32:01", level: "info", tool: "Masscan", message: "Open port detected: 445/tcp (SMB) on 192.168.1.10" },
            { timestamp: "2024-01-15 10:32:02", level: "info", tool: "Masscan", message: "Open port detected: 3389/tcp (RDP) on 192.168.1.10" },
            { timestamp: "2024-01-15 10:32:03", level: "success", tool: "Masscan", message: "Masscan completed successfully" },
            { timestamp: "2024-01-15 10:35:01", level: "info", tool: "Nessus", message: "Initializing vulnerability scanner" },
            { timestamp: "2024-01-15 10:35:02", level: "info", tool: "Nessus", message: "Loading vulnerability database..." },
            { timestamp: "2024-01-15 10:35:03", level: "warning", tool: "Nessus", message: "CVE-2021-44228 (Log4Shell) detected on 192.168.1.10:8080" },
            { timestamp: "2024-01-15 10:35:04", level: "error", tool: "Nessus", message: "Critical vulnerability CVE-2020-1472 (Zerologon) found" },
            { timestamp: "2024-01-15 10:35:05", level: "warning", tool: "Nessus", message: "SMB vulnerabilities detected on multiple hosts" },
            { timestamp: "2024-01-15 10:35:06", level: "success", tool: "Nessus", message: "Vulnerability scan completed" },
            { timestamp: "2024-01-15 10:30:00", level: "info", tool: "System", message: "Starting scanning process..." },
            { timestamp: "2024-01-15 10:30:05", level: "info", tool: "Nmap", message: "Nmap scan started on 192.168.1.0/24 (TCP SYN scan)" },
            { timestamp: "2024-01-15 10:30:06", level: "success", tool: "Nmap", message: "Discovered host: 192.168.1.1 (Gateway)" },
            { timestamp: "2024-01-15 10:30:07", level: "success", tool: "Nmap", message: "Discovered host: 192.168.1.10 (Windows Server)" },
            { timestamp: "2024-01-15 10:30:08", level: "info", tool: "Nmap", message: "Port scan: 22/tcp open ssh" },
            { timestamp: "2024-01-15 10:30:09", level: "info", tool: "Nmap", message: "Port scan: 80/tcp open http" },
            { timestamp: "2024-01-15 10:30:10", level: "info", tool: "Nmap", message: "Port scan: 443/tcp open https" },
            { timestamp: "2024-01-15 10:30:11", level: "success", tool: "Nmap", message: "Nmap scan completed successfully" },
            { timestamp: "2024-01-15 10:31:00", level: "info", tool: "ARP-Scan", message: "ARP scan initiated for local network" },
            { timestamp: "2024-01-15 10:31:01", level: "success", tool: "ARP-Scan", message: "Discovered host: 192.168.1.20 (Linux Workstation)" },
            { timestamp: "2024-01-15 10:31:02", level: "success", tool: "ARP-Scan", message: "Discovered host: 192.168.1.30 (Printer)" },
            { timestamp: "2024-01-15 10:31:03", level: "success", tool: "ARP-Scan", message: "ARP scan completed successfully" },
            { timestamp: "2024-01-15 10:32:00", level: "info", tool: "Masscan", message: "Masscan initiated on 192.168.1.0/24 (high-speed scan)" },
            { timestamp: "2024-01-15 10:32:01", level: "info", tool: "Masscan", message: "Open port detected: 445/tcp (SMB) on 192.168.1.10" },
            { timestamp: "2024-01-15 10:32:02", level: "info", tool: "Masscan", message: "Open port detected: 3389/tcp (RDP) on 192.168.1.10" },
            { timestamp: "2024-01-15 10:32:03", level: "success", tool: "Masscan", message: "Masscan completed successfully" },
            { timestamp: "2024-01-15 10:35:01", level: "info", tool: "Nessus", message: "Initializing vulnerability scanner" },
            { timestamp: "2024-01-15 10:35:02", level: "info", tool: "Nessus", message: "Loading vulnerability database..." },
            { timestamp: "2024-01-15 10:35:03", level: "warning", tool: "Nessus", message: "CVE-2021-44228 (Log4Shell) detected on 192.168.1.10:8080" },
            { timestamp: "2024-01-15 10:35:04", level: "error", tool: "Nessus", message: "Critical vulnerability CVE-2020-1472 (Zerologon) found" },
            { timestamp: "2024-01-15 10:35:05", level: "warning", tool: "Nessus", message: "SMB vulnerabilities detected on multiple hosts" },
            { timestamp: "2024-01-15 10:35:06", level: "success", tool: "Nessus", message: "Vulnerability scan completed" },
        ],
        []
    )

    const events = useMemo(
        () => [
            { time: "10:30:15", event: "Reconnaissance Started", status: "completed" },
            { time: "10:32:45", event: "5 Hosts Discovered", status: "completed" },
            { time: "10:35:01", event: "Vulnerability Scan Started", status: "completed" },
            { time: "10:37:22", event: "Critical Vulnerabilities Found", status: "warning" },
            { time: "10:40:15", event: "Exploitation Phase Ready", status: "pending" },
        ],
        []
    )

    const [visibleCount, setVisibleCount] = useState(0)
    const [playing, setPlaying] = useState(true)
    const [finished, setFinished] = useState(false)

    const timerRef = useRef<number | null>(null)
    const scrollViewportRef = useRef<HTMLDivElement | null>(null)

    const getLevelColor = (level: string) => {
        switch (level) {
            case "success":
                return "text-green-400"
            case "warning":
                return "text-yellow-400"
            case "error":
                return "text-red-400"
            default:
                return ""
        }
    }

    const getLevelIcon = (level: string) => {
        switch (level) {
            case "success":
                return <CheckCircle className="w-3 h-3" />
            case "warning":
                return <AlertCircle className="w-3 h-3" />
            case "error":
                return <AlertCircle className="w-3 h-3" />
            default:
                return <Clock className="w-3 h-3" />
        }
    }

    useEffect(() => {
        if (!playing || finished) return

        timerRef.current = window.setInterval(() => {
            setVisibleCount((prev) => {
                const next = prev + 1
                if (next >= logs.length) {
                    window.clearInterval(timerRef.current!)
                    timerRef.current = null
                    setFinished(true)
                    if (loop) {
                        setTimeout(() => {
                            setVisibleCount(0)
                            setFinished(false)
                            setPlaying(true)
                        }, 600)
                    }
                    return logs.length
                }
                return next
            })
        }, Math.max(60, lineIntervalMs))

        return () => {
            if (timerRef.current) {
                window.clearInterval(timerRef.current)
                timerRef.current = null
            }
        }
    }, [playing, finished, logs.length, lineIntervalMs, loop])

    useEffect(() => {
        const vp = scrollViewportRef.current
        if (!vp) return
        vp.scrollTo({ top: vp.scrollHeight, behavior: "smooth" })
    }, [visibleCount])

    const onRestart = () => {
        setVisibleCount(0)
        setFinished(false)
        setPlaying(true)
    }

    const onToggle = () => {
        if (finished) return
        setPlaying((p) => !p)
    }

    const defaultHeight = 500
    const minHeight = 60
    const [height, setHeight] = useState(defaultHeight)

    const togglePanelHeight = () => {
        setHeight((prev) => (prev === defaultHeight ? minHeight : defaultHeight))
    }

    const visibleLogs = useMemo(() => logs.slice(0, visibleCount), [logs, visibleCount])

    return (
        <Card
            className="relative transition-all duration-300 overflow-hidden ml-auto border-0 pt-2"
        // style={{ height }}
        >
            {/* <CardHeader className="p-2">
                <div className="flex items-center justify-between">
                    <CardTitle className="flex items-center gap-2">
                        <Terminal className="w-5 h-5" />
                        Scan Logs & Events
                    </CardTitle>
                    <div className="flex items-center gap-2">
                        <Button size="icon" variant="ghost" onClick={togglePanelHeight} title="Minimize/Restore Panel">
                            <X className="w-4 h-4" />
                        </Button>
                    </div>
                </div>
            </CardHeader> */}

            <CardContent>
                <Tabs defaultValue="logs">
                    <TabsList className="grid grid-cols-3">
                        <TabsTrigger value="logs">Raw Logs</TabsTrigger>
                        <TabsTrigger value="events">Events Timeline</TabsTrigger>
                        <TabsTrigger value="tools">Tool Output</TabsTrigger>
                    </TabsList>

                    <TabsContent value="logs" className="mt-4 overflow-auto" style={{ height: resizablePanelHeight - 80 }}>
                        <ScrollArea className={`rounded border p-4`}>
                            <div ref={scrollViewportRef} className="font-mono text-sm space-y-1">
                                {visibleLogs.map((log, i) => (
                                    <div key={i} className={`flex items-start gap-2 ${getLevelColor(log.level)}`}>
                                        <span className="shrink-0">[{log.timestamp}]</span>
                                        <div className="flex items-center gap-1 shrink-0 w-24">
                                            {getLevelIcon(log.level)}
                                            <Badge variant="outline" className="text-xs border">
                                                {log.tool}
                                            </Badge>
                                        </div>
                                        <span>{log.message}</span>
                                    </div>
                                ))}
                                <div className={`${finished ? "text-green-400" : "text-yellow-400"} ${finished ? "" : "animate-pulse"}`}>█</div>
                            </div>
                        </ScrollArea>
                    </TabsContent>

                    <TabsContent value="events" className="mt-4 overflow-auto" style={{ height: resizablePanelHeight - 80 }}>
                        <ScrollArea className={`rounded border p-4`}>
                            <div className="space-y-3">
                                {events.map((event, i) => (
                                    <div key={i} className="flex items-center gap-3">
                                        <div className="font-mono text-sm shrink-0">{event.time}</div>
                                        <div className={`w-2 h-2 rounded-full shrink-0 ${event.status === "completed" ? "bg-green-500" : event.status === "warning" ? "bg-yellow-500" : ""}`} />
                                        <div>{event.event}</div>
                                        <Badge
                                            variant="outline"
                                            className={`ml-auto text-xs ${event.status === "completed"
                                                ? "border-green-700 text-green-400"
                                                : event.status === "warning"
                                                    ? "border-yellow-700 text-yellow-400"
                                                    : "border"
                                                }`}
                                        >
                                            {event.status}
                                        </Badge>
                                    </div>
                                ))}
                            </div>
                        </ScrollArea>
                    </TabsContent>

                    <TabsContent value="tools" className="mt-4 overflow-auto" style={{ height: resizablePanelHeight - 80 }}>
                        <ScrollArea className={`rounded border p-4`}>
                            <div className="font-mono text-sm space-y-2">
                                <div className="text-blue-400"># Nmap scan results</div>
                                <div>Starting Nmap 7.94 ( https://nmap.org )</div>
                                <div>Nmap scan report for 192.168.1.10</div>
                                <div>Host is up (0.00050s latency).</div>
                                <div className="text-green-400">PORT STATE SERVICE</div>
                                <div className="text-green-400">22/tcp open ssh</div>
                                <div className="text-green-400">80/tcp open http</div>
                                <div className="text-green-400">443/tcp open https</div>
                                <div className="text-green-400">3389/tcp open ms-wbt-server</div>
                                <div>MAC Address: 00:50:56:C0:00:08 (VMware)</div>
                                <div className="text-yellow-400 animate-pulse">█</div>
                            </div>
                        </ScrollArea>
                    </TabsContent>
                </Tabs>
            </CardContent>
        </Card>
    )
}
